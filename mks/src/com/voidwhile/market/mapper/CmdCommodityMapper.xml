<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.voidwhile.market.mapper.CmdCommodityMapper">
  <resultMap id="BaseResultMap" type="com.voidwhile.market.entity.CmdCommodity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="cmd_id" jdbcType="BIGINT" property="cmdId" />
    <result column="cmd_name" jdbcType="VARCHAR" property="cmdName" />
    <result column="cmd_code" jdbcType="VARCHAR" property="cmdCode" />
    <result column="cmd_brand" jdbcType="BIGINT" property="cmdBrand" />
    <result column="cmd_status" jdbcType="INTEGER" property="cmdStatus" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="putaway_time" jdbcType="TIMESTAMP" property="putawayTime" />
    <result column="shelf_life" jdbcType="VARCHAR" property="shelfLife" />
    <result column="description" jdbcType="VARCHAR" property="description" />
    <result column="produce_date" jdbcType="TIMESTAMP" property="produceDate" />
    <result column="expiration_date" jdbcType="TIMESTAMP" property="expirationDate" />
    <result column="supplier_id" jdbcType="BIGINT" property="supplierId" />
    <result column="img_path" jdbcType="VARCHAR" property="imgPath" />
    <result column="cc_cmd_type" jdbcType="INTEGER" property="ccCmdType" />
    <result column="prod_place" jdbcType="VARCHAR" property="prodPlace" />
    <result column="storage_condition" jdbcType="VARCHAR" property="storageCondition" />
    <result column="event_price" jdbcType="VARCHAR" property="eventPrice" />
    <result column="price" jdbcType="DECIMAL" property="price" />
    <result column="typeName" jdbcType="VARCHAR" property="typeName" />
    <result column="cc_price_id" jdbcType="BIGINT" property="ccPriceId" />
    <association property="status" column="cmd_status" javaType="com.voidwhile.market.entity.CmdStatus" select="com.voidwhile.market.mapper.CmdStatusMapper.selectByPrimaryKey"/>
    <association property="brand" column="cmd_brand" javaType="com.voidwhile.market.entity.CmdBrand" select="com.voidwhile.market.mapper.CmdBrandMapper.selectByPrimaryKey"/>
    <association property="supplier" column="supplier_id" javaType="com.voidwhile.market.entity.RepSupplier" select="com.voidwhile.market.mapper.RepSupplierMapper.selectByPrimaryKey"/>
	<collection property="labels" ofType="com.voidwhile.market.entity.CmdLabel" column="cmd_id" select="com.voidwhile.market.mapper.CmdLabelMapper.selectByCmdId"/>   
	<collection property="sfts" ofType="com.voidwhile.market.entity.CmdSpecification" column="cmd_id" select="com.voidwhile.market.mapper.CmdSpecificationMapper.selectByCmdId"/>   
	<collection property="images" ofType="com.voidwhile.market.entity.PubImage" column="cmd_id" select="selectImages"/>   
  </resultMap>
  <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="com.voidwhile.market.entity.CmdCommodity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="description" jdbcType="LONGVARCHAR" property="description" />
  </resultMap>
  <resultMap id="OptionsMap" type="com.voidwhile.market.entity.CmdCommodity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="cmd_id" jdbcType="BIGINT" property="cmdId" />
    <result column="cmd_name" jdbcType="VARCHAR" property="cmdName" />
     
  </resultMap>
  
  <resultMap id="ImageResultMap" type="com.voidwhile.market.entity.PubImage">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="img_id" jdbcType="BIGINT" property="imgId" />
		<result column="img_type" jdbcType="INTEGER" property="imgType" />
		<result column="imgname" jdbcType="VARCHAR" property="imgname" />
		<result column="path" jdbcType="VARCHAR" property="path" />
		<result column="biztype" jdbcType="INTEGER" property="biztype" />
		<result column="bizid" jdbcType="VARCHAR" property="bizid" />
  </resultMap>
  <sql id="Base_Column_List">
    mcc.cmd_id, cmd_name, cmd_code, cmd_brand, cmd_status, create_time, putaway_time, shelf_life, 
    produce_date, expiration_date, supplier_id,description,img_path,cc_cmd_type,cc_price_id, prod_place, storage_condition,price,(SELECT
    price
  FROM
    mk_cmd_price mcp,
    mk_eve_event mee,
    mk_eve_event_cmd mec
  WHERE mcp.cmd_id = mcc.cmd_id
    AND mcp.event_id = mee.event_id
    AND mee.event_id = mec.event_id
    AND mec.cmd_id = mcp.cmd_id
    AND mee.start_time <![CDATA[ <= ]]> NOW()
    AND mee.end_time <![CDATA[ >= ]]> NOW()
    AND price_type = 2
    ) as event_price,
    (select CONCAT(b.type_name,'>',a.type_name) from mk_cmd_type a,mk_cmd_type b where a.parent_id = b.cmd_type and a.cmd_type = mcc.cc_cmd_type) as typeName
  </sql>
  <sql id="Blob_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    description
  </sql>
  <sql id="selectWhereClause">

			<if test="cmdId !=null">
				and cmd_id = #{cmdId,jdbcType=BIGINT}
			</if>
			<if test="cmdName !=null and cmdName!=''">
				and cmd_name like CONCAT('%',#{cmdName},'%')
			</if>
			<if test="cmdCode !=null">
				and cmd_code = #{cmdCode,jdbcType=VARCHAR}
			</if>
			<if test="cmdType !=null">
				and cc_cmd_type = #{cmdType,jdbcType=INTEGER}
			</if>
			<if test="cmdBrand !=null">
				and cmd_brand = #{cmdBrand,jdbcType=BIGINT}
			</if>
			<if test="cmdStatus !=null">
				and cmd_status = #{cmdStatus,jdbcType=INTEGER}
			</if>
			<if test="putawayTime !=null">
				and putaway_time = #{putawayTime,jdbcType=TIMESTAMP}
			</if>
			<if test="shelfLife !=null">
				and shelf_life = #{shelfLife,jdbcType=VARCHAR}
			</if>
			<if test="produceDate !=null">
				and produce_date = #{produceDate,jdbcType=TIMESTAMP}
			</if>
			<if test="expirationDate !=null">
				and expiration_date = #{expirationDate,jdbcType=TIMESTAMP}
			</if>
			<if test="supplierId !=null">
				and supplier_id = #{supplierId,jdbcType=BIGINT}
			</if>
			<if test="label !=null">
				and mcc.cmd_id in (select mcl.cmd_id from mk_cmd_label mcl where mcl.cmd_type=#{label})
			</if>
			
		
  </sql>
  
  <select id="findOption" resultMap="OptionsMap">
  	select 
  	cmd_id,cmd_name
  	from mk_cmd_commodity 
  </select>
  
  <select id="selectImages" parameterType="java.lang.Long" resultMap="ImageResultMap">
  select img_id,  img_type,imgname, path, biztype,bizid
    from mk_pub_image
    where biztype = 2
    and bizid = #{cmd_id,jdbcType=BIGINT}
  </select>
  
  <select id="selectByMap" parameterType="java.util.Map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from mk_cmd_commodity mcc,mk_cmd_price mcp
    where mcc.cc_price_id = mcp.price_id
    <include refid="selectWhereClause" />
    <if test="orderByClause != null">
		order by ${orderByClause}
	</if>
	<if test="offset != null and pageSize != null">
		limit #{offset} , #{pageSize}
	</if>
  </select>
  <select id="countByMap" parameterType="java.util.Map" resultType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    count(mcc.cmd_id)
    from mk_cmd_commodity mcc,mk_cmd_price mcp
    where mcc.cc_price_id = mcp.price_id
    <include refid="selectWhereClause" />
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from mk_cmd_commodity mcc,mk_cmd_price mcp
    where mcc.cc_price_id = mcp.price_id
      and mcc.cmd_id = #{cmdId,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from mk_cmd_commodity
    where cmd_id = #{cmdId,jdbcType=BIGINT}
  </delete>
  <delete id="deleteByIds" parameterType="java.lang.Integer">
	<!-- WARNING - @mbg.generated This element is automatically generated by 
		MyBatis Generator, do not modify. -->
	delete from mk_cmd_commodity
	where cmd_id in
	<foreach collection="array" index="index" item="item" open="("
		separator="," close=")">
		#{item}
	</foreach>
  </delete>
  <insert id="insert" parameterType="com.voidwhile.market.entity.CmdCommodity" keyProperty="cmdId" useGeneratedKeys="true">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into mk_cmd_commodity ( cmd_name, cmd_code, 
      cmd_brand, cmd_status, create_time, 
      putaway_time, shelf_life, produce_date, 
      expiration_date, supplier_id, img_path, 
      cc_cmd_type, prod_place, storage_condition, 
      description,cc_price_id)
    values (#{cmdName,jdbcType=VARCHAR}, #{cmdCode,jdbcType=VARCHAR}, 
      #{cmdBrand,jdbcType=BIGINT}, #{cmdStatus,jdbcType=INTEGER}, #{createTime,jdbcType=TIMESTAMP}, 
      #{putawayTime,jdbcType=TIMESTAMP}, #{shelfLife,jdbcType=VARCHAR}, #{produceDate,jdbcType=TIMESTAMP}, 
      #{expirationDate,jdbcType=TIMESTAMP}, #{supplierId,jdbcType=BIGINT}, #{imgPath,jdbcType=VARCHAR}, 
      #{ccCmdType,jdbcType=INTEGER}, #{prodPlace,jdbcType=VARCHAR}, #{storageCondition,jdbcType=VARCHAR}, 
      #{description,jdbcType=LONGVARCHAR},#{ccPriceId,jdbcType=BIGINT})
  </insert>
  <insert id="insertSelective" parameterType="com.voidwhile.market.entity.CmdCommodity" keyProperty="cmdId" useGeneratedKeys="true">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into mk_cmd_commodity
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="ccPriceId != null">
        cc_price_id,
      </if>
      <if test="cmdName != null">
        cmd_name,
      </if>
      <if test="cmdCode != null">
        cmd_code,
      </if>
      <if test="cmdBrand != null">
        cmd_brand,
      </if>
      <if test="cmdStatus != null">
        cmd_status,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="putawayTime != null">
        putaway_time,
      </if>
      <if test="shelfLife != null">
        shelf_life,
      </if>
      <if test="produceDate != null">
        produce_date,
      </if>
      <if test="expirationDate != null">
        expiration_date,
      </if>
      <if test="supplierId != null">
        supplier_id,
      </if>
      <if test="imgPath != null">
        img_path,
      </if>
      <if test="ccCmdType != null">
        cc_cmd_type,
      </if>
      <if test="prodPlace != null">
        prod_place,
      </if>
      <if test="storageCondition != null">
        storage_condition,
      </if>
      <if test="description != null">
        description,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="ccPriceId != null">
        #{ccPriceId,jdbcType=BIGINT},
      </if>
      <if test="cmdName != null">
        #{cmdName,jdbcType=VARCHAR},
      </if>
      <if test="cmdCode != null">
        #{cmdCode,jdbcType=VARCHAR},
      </if>
      <if test="cmdBrand != null">
        #{cmdBrand,jdbcType=BIGINT},
      </if>
      <if test="cmdStatus != null">
        #{cmdStatus,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="putawayTime != null">
        #{putawayTime,jdbcType=TIMESTAMP},
      </if>
      <if test="shelfLife != null">
        #{shelfLife,jdbcType=VARCHAR},
      </if>
      <if test="produceDate != null">
        #{produceDate,jdbcType=TIMESTAMP},
      </if>
      <if test="expirationDate != null">
        #{expirationDate,jdbcType=TIMESTAMP},
      </if>
      <if test="supplierId != null">
        #{supplierId,jdbcType=BIGINT},
      </if>
      <if test="imgPath != null">
        #{imgPath,jdbcType=VARCHAR},
      </if>
      <if test="ccCmdType != null">
        #{ccCmdType,jdbcType=INTEGER},
      </if>
      <if test="prodPlace != null">
        #{prodPlace,jdbcType=VARCHAR},
      </if>
      <if test="storageCondition != null">
        #{storageCondition,jdbcType=VARCHAR},
      </if>
      <if test="description != null">
        #{description,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.voidwhile.market.entity.CmdCommodity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update mk_cmd_commodity
    <set>
      <if test="cmdName != null">
        cmd_name = #{cmdName,jdbcType=VARCHAR},
      </if>
      <if test="cmdCode != null">
        cmd_code = #{cmdCode,jdbcType=VARCHAR},
      </if>
      <if test="cmdBrand != null">
        cmd_brand = #{cmdBrand,jdbcType=BIGINT},
      </if>
      <if test="cmdStatus != null">
        cmd_status = #{cmdStatus,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="putawayTime != null">
        putaway_time = #{putawayTime,jdbcType=TIMESTAMP},
      </if>
      <if test="shelfLife != null">
        shelf_life = #{shelfLife,jdbcType=VARCHAR},
      </if>
      <if test="produceDate != null">
        produce_date = #{produceDate,jdbcType=TIMESTAMP},
      </if>
      <if test="expirationDate != null">
        expiration_date = #{expirationDate,jdbcType=TIMESTAMP},
      </if>
      <if test="supplierId != null">
        supplier_id = #{supplierId,jdbcType=BIGINT},
      </if>
      <if test="imgPath != null">
        img_path = #{imgPath,jdbcType=VARCHAR},
      </if>
      <if test="ccCmdType != null">
        cc_cmd_type = #{ccCmdType,jdbcType=INTEGER},
      </if>
      <if test="prodPlace != null">
        prod_place = #{prodPlace,jdbcType=VARCHAR},
      </if>
      <if test="storageCondition != null">
        storage_condition = #{storageCondition,jdbcType=VARCHAR},
      </if>
      <if test="description != null">
        description = #{description,jdbcType=LONGVARCHAR},
      </if>
      <if test="ccPriceId != null">
        cc_price_id = #{ccPriceId,jdbcType=BIGINT},
      </if>
    </set>
    where cmd_id = #{cmdId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.voidwhile.market.entity.CmdCommodity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update mk_cmd_commodity
    set cmd_name = #{cmdName,jdbcType=VARCHAR},
      cmd_code = #{cmdCode,jdbcType=VARCHAR},
      cmd_brand = #{cmdBrand,jdbcType=BIGINT},
      cmd_status = #{cmdStatus,jdbcType=INTEGER},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      putaway_time = #{putawayTime,jdbcType=TIMESTAMP},
      shelf_life = #{shelfLife,jdbcType=VARCHAR},
      produce_date = #{produceDate,jdbcType=TIMESTAMP},
      expiration_date = #{expirationDate,jdbcType=TIMESTAMP},
      supplier_id = #{supplierId,jdbcType=BIGINT},
      img_path = #{imgPath,jdbcType=VARCHAR},
      cc_cmd_type = #{ccCmdType,jdbcType=INTEGER},
      prod_place = #{prodPlace,jdbcType=VARCHAR},
      storage_condition = #{storageCondition,jdbcType=VARCHAR},
      cc_price_id = #{ccPriceId,jdbcType=BIGINT},
      description = #{description,jdbcType=LONGVARCHAR}
    where cmd_id = #{cmdId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.voidwhile.market.entity.CmdCommodity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update mk_cmd_commodity
    set cmd_name = #{cmdName,jdbcType=VARCHAR},
      cmd_code = #{cmdCode,jdbcType=VARCHAR},
      cmd_brand = #{cmdBrand,jdbcType=BIGINT},
      cmd_status = #{cmdStatus,jdbcType=INTEGER},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      putaway_time = #{putawayTime,jdbcType=TIMESTAMP},
      shelf_life = #{shelfLife,jdbcType=VARCHAR},
      produce_date = #{produceDate,jdbcType=TIMESTAMP},
      expiration_date = #{expirationDate,jdbcType=TIMESTAMP},
      supplier_id = #{supplierId,jdbcType=BIGINT},
      img_path = #{imgPath,jdbcType=VARCHAR},
      cc_cmd_type = #{ccCmdType,jdbcType=INTEGER},
      prod_place = #{prodPlace,jdbcType=VARCHAR},
      cc_price_id = #{ccPriceId,jdbcType=BIGINT},
      storage_condition = #{storageCondition,jdbcType=VARCHAR}
    where cmd_id = #{cmdId,jdbcType=BIGINT}
  </update>
</mapper>